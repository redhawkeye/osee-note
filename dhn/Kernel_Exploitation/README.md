# Kernel Exploitation

## IOCTL

 Decodes 32-Bit Windows Device I/O control codes.
 
 This script based on the "Windows Driver Plugin" IDA Pro plugin written by Sam Brown:
 * https://github.com/mwrlabs/z3_and_angr_binary_analysis_workshop/ (Sam Brown)
 * https://github.com/mwrlabs/win_driver_plugin (Sam Brown)
 * https://github.com/tandasat/WinIoCtlDecoder/blob/master/plugins/WinIoCtlDecoder.py (Satoshi Tanda)

```
(1)+8:58% ./ioctl.py -f HEVD.sys
[+] Device name: \Device\HackSysExtremeVulnerableDriver
[+] Dispatch function found: 0x444064
Address    | IOCTL Code | Device                           | Function   | Method                 | Access
-----------+------------+----------------------------------+------------+------------------------+----------------------
0x44409F   | 0x222003   | FILE_DEVICE_UNKNOWN   0x22       | 0x800      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4440CF   | 0x222007   | FILE_DEVICE_UNKNOWN   0x22       | 0x801      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444113   | 0x22200F   | FILE_DEVICE_UNKNOWN   0x22       | 0x803      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4440F1   | 0x22200B   | FILE_DEVICE_UNKNOWN   0x22       | 0x802      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x44417F   | 0x22201B   | FILE_DEVICE_UNKNOWN   0x22       | 0x806      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x44415A   | 0x222017   | FILE_DEVICE_UNKNOWN   0x22       | 0x805      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4441A4   | 0x22201F   | FILE_DEVICE_UNKNOWN   0x22       | 0x807      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444091   | 0x222023   | FILE_DEVICE_UNKNOWN   0x22       | 0x808      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4441EE   | 0x222027   | FILE_DEVICE_UNKNOWN   0x22       | 0x809      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444213   | 0x22202B   | FILE_DEVICE_UNKNOWN   0x22       | 0x80A      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444238   | 0x22202F   | FILE_DEVICE_UNKNOWN   0x22       | 0x80B      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x44425D   | 0x222033   | FILE_DEVICE_UNKNOWN   0x22       | 0x80C      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444282   | 0x222037   | FILE_DEVICE_UNKNOWN   0x22       | 0x80D      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4442A7   | 0x22203B   | FILE_DEVICE_UNKNOWN   0x22       | 0x80E      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4442CC   | 0x22203F   | FILE_DEVICE_UNKNOWN   0x22       | 0x80F      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4442F1   | 0x222043   | FILE_DEVICE_UNKNOWN   0x22       | 0x810      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4444AD   | 0x222044   | FILE_DEVICE_UNKNOWN   0x22       | 0x811      | METHOD_BUFFERED   0    | FILE_ANY_ACCESS (0)
0x444316   | 0x222047   | FILE_DEVICE_UNKNOWN   0x22       | 0x811      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x44433B   | 0x22204B   | FILE_DEVICE_UNKNOWN   0x22       | 0x812      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444360   | 0x22204F   | FILE_DEVICE_UNKNOWN   0x22       | 0x813      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444385   | 0x222053   | FILE_DEVICE_UNKNOWN   0x22       | 0x814      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4443AA   | 0x222057   | FILE_DEVICE_UNKNOWN   0x22       | 0x815      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4443CF   | 0x22205B   | FILE_DEVICE_UNKNOWN   0x22       | 0x816      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x4443F4   | 0x22205F   | FILE_DEVICE_UNKNOWN   0x22       | 0x817      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444419   | 0x222063   | FILE_DEVICE_UNKNOWN   0x22       | 0x818      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x44443E   | 0x222067   | FILE_DEVICE_UNKNOWN   0x22       | 0x819      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444463   | 0x22206B   | FILE_DEVICE_UNKNOWN   0x22       | 0x81A      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444488   | 0x22206F   | FILE_DEVICE_UNKNOWN   0x22       | 0x81B      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
0x444135   | 0x222013   | FILE_DEVICE_UNKNOWN   0x22       | 0x804      | METHOD_NEITHER    3    | FILE_ANY_ACCESS (0)
+8:58%

```
